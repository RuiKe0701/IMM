<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >

<mapper namespace="team.ruike.imm.dao.SalesDao">
    <resultMap id="salesMap" type="sales">
        <result column="sales_id" property="salesId" />
        <result column="sales_date" property="salesDate" />
        <result column="client_id"  property="clientId"/>
        <result column="employee_id" property="employeeId"/>
        <result column="sales_accomplish" property="salesAccomplish"/>
        <result column="event_details_id" property="eventDetailsId"/>
        <result column="sales_activities" property="salesActivities"/>
        <result column="sales_state" property="salesState"/>

        <collection property="client" ofType="client">
            <result column="client_id" property="clientId" />
            <result column="client_name" property="clientName" />
            <result column="client_person_in_charge" property="clientPerson_inCharge" />
            <result column="client_post" property="clientPost" />
            <result column="client_phone" property="clientPhone"/>
            <result column="client_mobile_phone" property="clientMobilePhone"/>
            <result column="client_fax" property="clientFax" />
            <result column="client_address" property="clientAddress" />
            <result column="client_factory_address" property="client_factoryAddress" />
            <result column="client_state" property="clientState" />
        </collection>

        <collection property="employee" ofType="employee">
            <result column="employee_id" property="employeeId" />
            <result column="employee_name" property="employeeName" />
            <result column="position_id" property="positionId" />
            <result column="employee_id_number" property="employeeIdNumber" />
            <result column="employee_mobile_phone" property="employeeMobilePhone" />
            <result column="employee_email" property="employeeEmail" />
            <result column="employee_address" property="employeeAddress" />
            <result column="employee_state" property="employeeState" />
        </collection>

        <collection property="eventDetails" ofType="eventDetails">
            <result column="event_details_id" property="eventDetailsId"/>
            <result column="event_details_name" property="eventDetailsName"/>
            <result column="event_details_state" property="eventDetailsState"/>
        </collection>
    </resultMap>

    <select id="selectSales" resultMap="salesMap" parameterType="sales">
        select * from sales
        <where>
             1=1
            <if test="salesId!=null and salesId>0">
                   and sales_id=#{salesId}
            </if>
            <if test="salesDate !=null and salesDate!=''">
                   and sales_date=#{salesDate}
            </if>
            <if test="clientId !=null and clientId>0">
                   and client_id =#{clientId}
            </if>
            <if test="employeeId!=null and employeeId>0">
                 and employee_id =#{employeeId}
            </if>
            <if test="salesAccomplish!=null and salesAccomplish>0">
                 and sales_accomplish =#{salesAccomplish}
            </if>
            <if test="eventDetailsId!=null and eventDetailsId>=0">
                and event_details_id =#{eventDetailsId}
            </if>
            <if test="salesActivities!=null and salesActivities>=0">
                and sales_activities=#{salesActivities}
            </if>
            <if test="salesState !=null">
                and sales_state=#{salesState}
            </if>
        </where>
        <if test="currentPage!=null and pageSize!=null">
            LIMIT #{currentPage},#{pageSize}
        </if>
    </select>
    <update id="updateSales" parameterType="sales">
        update sales
        <set>
            <if test="salesId !=null and salesId!=''">
                  sales_id=#{salesId}
            </if>
            <if test="merchandiseId !=null and merchandiseId>0">
                  merchandise_id =#{merchandiseId}
            </if>
            <if test="siVolume!=null and siVolume>0">
                  si_volume =#{siVolume}
            </if>
            <if test="unitsId!=null and unitsId>0">
                  units_id =#{unitsId}
            </if>
            <if test="siActualPrice!=null and siActualPrice>=0">
                  si_actual_price =#{siActualPrice}
            </if>
            <if test="siState!=null">
                  si_state=#{siState}
            </if>
            <where>
                si_id=#{siId}
            </where>
        </set>
    </update>

    <insert id="insertSales" parameterType="sales">
    insert into sales values(#{salesId},#{salesDate},#{clientId},#{employeeId})
</insert>
</mapper>
<!---->
